<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="robots" content="noindex, nofollow">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
        <title>WAP - Edit Card: <%= toEdit.name %></title>
    </head>
    <body>
        <%- include("../partials/navbar.ejs") %>
        <div class="container-xxl bd-gutter flex-wrap flex-lg-nowrap p-5">
            <div class="row mb-5 text-center">
                <h1>Edit card: <%= toEdit.name %>></h1>
            </div>
            <div class="row">
                <form method="post" action="/cards/edit">
                    <div class="row">
                        <div class="col mb-3">
                            <label for="name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="name" name="name" value="<%= toEdit.name %>">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <label for="who" class="form-label">As a</label>
                            <input type="text" class="form-control" id="who" name="who" value="<%=toEdit.asWho %>">
                        </div>
                        <div class="col mb-3">
                            <label for="task" class="form-label">I want to</label>
                            <input type="text" class="form-control" id="task" name="task" value="<%= toEdit.task %>">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <label for="description" class="form-label">Descrption</label>
                            <textarea type="textarea" class="form-control" id="description" name="description"><%= toEdit.description %></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <label for="part" class="form-label">Part</label>
                            <select class="form-select" id="part" name="part">
                                <% for (const part of wap.parts) { %>
                                    <option value="<%= part.id %>" <%= (toEdit.part.id == part.id) ? "selected=true": "" %>><%= part.name %></option>
                                <% } %>
                            </select>
                        </div>
                        <div class="col mb-3">
                            <label for="workingDays" class="form-label">J/H</label>
                            <input type="number" class="form-control" id="workingDays" name="workingDays" value="<%= toEdit.workingDays %>">
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <label for="dods" class="form-label">Definitions of Done</label>
                            <textarea type="textarea" class="form-control" id="dods" name="dods"><%= toEdit.dods %></textarea>
                            <div id="assigneesHelp" class="form-text">Each dod must be put on a newline.</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col mb-3">
                            <label for="assignees" class="form-label">Assigneees</label>
                            <select class="form-select" id="assignees" multiple aria-describedby="assigneesHelp" name="assignees">
                                <% for (const auser of wap.users) { %>
                                    <option value="<%= auser.id %>" <%= (assigneesId.includes(auser.id) ? "selected=true" : "") %>><%= auser.firstname + " " + auser.lastname %></option>
                                <% } %>
                            </select>
                            <div id="assigneesHelp" class="form-text">Warning: You are not assigneed automatically to a task when editing it from the administrative part</div>
                        </div>
                    </div>
                    <input type="text" hidden value="<%= toEdit.id %>" name="id">
                    <button type="submit" class="btn btn-success">Save</button>
                </form>
            </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    </body>
</html>